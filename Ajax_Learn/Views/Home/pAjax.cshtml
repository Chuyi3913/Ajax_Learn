
@{
    ViewData["Title"] = "pAjax";
}

<h1>pAjax</h1>
<form method="post" name="formUser">
    <div class="mb-3">
        <label for="Name" class="form-label">姓名</label>
        <input type="text" name="Name" id="Name" class="form-control" />
    </div>
    <div class="mb-3">
        <label for="Email" class="form-label">Email</label>
        <input type="text" name="Email" id="Email" class="form-control" />
    </div>
    <div class="mb-3">
        <label for="Age" class="form-label">年齡</label>
        <input type="text" name="Age" id="Age" class="form-control"/>
    </div>
    <div class="mb-3">
        <label for="fileForm" class="form-label">照片上傳</label>
        <input type="file" name="photo" id="fileForm" class="form-control" />
    </div>
    <div class="mb-3">
        <input type="submit" value="送出" class="btn btn-primary mb-3" />
    </div>
</form>

<div id="div1"></div>


@section Scripts{
    <script>
        const btn = document.querySelector('input[type="submit"]');
        const theDiv=document.querySelector("#div1");
        btn.addEventListener("click", (event) => {
            event.preventDefault();
        var xhr=new XMLHttpRequest();
        var formData=new FormData(document.formUser);

            xhr.addEventListener('load', () => {
                //接收資料
                const data = xhr.responseText;
                //顯示資料
                theDiv.innerHTML =data;
            })

        xhr.open("post", "@Url.Content("~/api/Create")")
        xhr.send(formData);

        });
        //const xhr = new XMLHttpRequest();
        //xhr.addEventListener('load', () => {
        //    document.querySelector('#div1').innerHTML = xhr.responseText;
        //})
        //xhr.open("POST", "@Url.Content("/api/index")");
        //xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        //xhr.send("name=Jack&age=30");
    </script>
}